---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - go.mod
  - go.sum
  - cmd/openclaw-trace/main.go
  - internal/config/config.go
  - internal/logging/logging.go
  - internal/server/server.go
  - internal/server/health.go
autonomous: true
requirements:
  - FOUN-01
  - FOUN-02
  - FOUN-04
  - FOUN-05
must_haves:
  truths:
    - "Binary starts with OCT_* environment config and JSON slog enabled."
    - "GET /health responds with status payload including uptime and queue/push placeholders."
    - "Build path supports CGO-disabled Linux target."
  artifacts:
    - path: "cmd/openclaw-trace/main.go"
      provides: "Process bootstrap and HTTP server wiring"
    - path: "internal/config/config.go"
      provides: "Environment configuration with OCT_* defaults"
    - path: "internal/server/health.go"
      provides: "Health endpoint response contract"
  key_links:
    - from: "cmd/openclaw-trace/main.go"
      to: "internal/config/config.go"
      via: "config.Load() during startup"
      pattern: "Load\\("
    - from: "cmd/openclaw-trace/main.go"
      to: "internal/server/health.go"
      via: "GET /health route registration"
      pattern: "GET /health"
---

<objective>
Stand up the Phase 1 service skeleton: static Go module, OCT_* env configuration, structured JSON logging, HTTP server bootstrap, and contract-correct health endpoint.

Purpose: Establish a stable runtime skeleton so SQLite integration and graceful shutdown can be added without refactors.
Output: Compile-ready project layout with runnable `openclaw-trace` binary and validated `/health` response shape.
</objective>

<execution_context>
@/Users/konradgnat/.claude/get-shit-done/workflows/execute-plan.md
@/Users/konradgnat/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize module and config/logging layer</name>
  <files>go.mod, go.sum, internal/config/config.go, internal/logging/logging.go</files>
  <action>Create Go module for openclaw-trace, add minimal dependencies (go-envconfig, google/uuid reserved for later phases, modernc/sqlite reserved for DB plan), and implement config loading using OCT_* env vars with defaults from CONTEXT.md. Implement slog JSON logger setup with level parsing from OCT_LOG_LEVEL and set as default logger. Include --help and --version flags in config/bootstrap path so runtime contract is present from phase start.</action>
  <verify>`go test ./...` (if no tests yet, command still succeeds) and `go run ./cmd/openclaw-trace --help` prints env-driven usage including OCT_PORT/OCT_DB_PATH/OCT_LOG_LEVEL/OCT_PUSH_ENDPOINT/OCT_PUSH_INTERVAL/OCT_RETENTION_DAYS/OCT_MAX_TEXT_BYTES.</verify>
  <done>Project compiles with config+logging packages present, OCT defaults match context decisions, and logger always emits JSON format.</done>
</task>

<task type="auto">
  <name>Task 2: Build HTTP bootstrap and health contract</name>
  <files>cmd/openclaw-trace/main.go, internal/server/server.go, internal/server/health.go</files>
  <action>Implement main process bootstrap using Go stdlib http server with explicit timeouts and method-aware route registration for GET /health. Health handler must always return HTTP 200 and include status, uptime_seconds, version, db_status, db_size_bytes, wal_size_bytes, queue_depth, events_received, events_dropped, last_push_time, last_push_status, unsynced_count. For pre-ingest phase, queue/push counters can be placeholder zero values but field names must be stable.</action>
  <verify>Start service with `go run ./cmd/openclaw-trace`, call `curl -s http://127.0.0.1:${OCT_PORT:-9090}/health`, and confirm JSON includes all contract keys and `status` is one of ok/degraded/error while HTTP status is 200.</verify>
  <done>Binary runs locally, exposes `/health`, and returns contract-complete JSON with deterministic field names.</done>
</task>

<task type="auto">
  <name>Task 3: Verify static build target and startup logs</name>
  <files>cmd/openclaw-trace/main.go</files>
  <action>Add startup log sequence matching context decisions: banner, config summary (mask push endpoint), and listening message. Ensure build command path supports `CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build ./...` without CGo requirements. Keep runtime behavior compatible with upcoming SQLite integration.</action>
  <verify>Run `CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build ./...` and confirm success; run local binary and inspect logs for ordered startup messages encoded as JSON lines.</verify>
  <done>FOUN-01/FOUN-05 build and logging expectations are satisfied and ready for DB/shutdown work.</done>
</task>

</tasks>

<verification>
- Local service returns 200 on `/health` with full JSON contract fields.
- Startup logs are valid JSON and follow agreed sequencing.
- Static Linux amd64 build succeeds with CGO disabled.
</verification>

<success_criteria>
- [ ] FOUN-01 covered by successful CGO-disabled Linux build.
- [ ] FOUN-02 covered by OCT_* env config parsing with defaults.
- [ ] FOUN-04 covered by GET /health 200 contract response.
- [ ] FOUN-05 covered by slog JSON logging with log-level control.
- [ ] Output creates a stable base for SQLite and graceful shutdown implementation.
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
